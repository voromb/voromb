name: Metrics
on:
  # Todos los días a las 06:00 UTC ≈ 08:00 Madrid
  schedule: [{ cron: "0 6 * * *" }]
  workflow_dispatch:
jobs:
  github-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      # Necesario para asegurar que el repositorio está correctamente clonado
      - name: Checkout
        uses: actions/checkout@v3
        
      # Usa la acción de métricas con template terminal personalizado
      - name: Generate hacker terminal metrics
        uses: lowlighter/metrics@latest
        with:
          # === Seguridad ===
          token: ${{ secrets.METRICS_TOKEN }}      # Tu PAT personal
          committer_token: ${{ secrets.GITHUB_TOKEN }}  # Para hacer el commit del SVG
          # === Configuración de archivo ===
          filename: github-metrics.svg             # Nombre resultante
          output_action: commit                    # Haz commit automático
          committer_branch: main                   # Define explícitamente la rama
          # === Configuración general ===
          template: terminal                       # Plantilla de terminal
          user: voromb                             # Tu usuario
          config_timezone: Europe/Madrid
          # === Personalización de estilo ===
          extras_css: |
            :root {
              --color-calendar-graph-day-bg: #1b1f230a;
              --color-terminal-text: #00ff00;
              --color-terminal-background: #000000;
              --color-terminal-border: #00ff00;
              --terminal-box-shadow: 0 3px 10px rgba(0, 255, 0, 0.25);
              --font: 'Courier New', monospace;
            }
            .terminal {
              background-color: var(--color-terminal-background) !important;
              border: 1px solid var(--color-terminal-border) !important;
              box-shadow: var(--terminal-box-shadow) !important;
            }
            .terminal text, .terminal * {
              font-family: var(--font) !important;
              color: var(--color-terminal-text) !important;
            }
            .terminal [data-terminal-type="input"]:after {
              color: var(--color-terminal-text) !important;
            }
          # === Bloques base ===
          base: header, activity, community, repositories
          # === Plugins ===
          plugin_languages: yes
          plugin_languages_limit: 8
          plugin_languages_details: bytes-size, percentage
          plugin_isocalendar: yes
          plugin_lines: yes
          plugin_habits: yes
          plugin_achievements: yes
          plugin_achievements_threshold: B         # Solo logros ≥ rango B
          plugin_followup: yes                     # "¿A quién sigues y te sigue?"
